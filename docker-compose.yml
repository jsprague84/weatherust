services:
  weatherust:
    image: ghcr.io/jsprague84/weatherust:latest
    env_file:
      - .env
    restart: "no"

  ofelia:
    image: mcuadros/ofelia:latest
    container_name: ofelia
    restart: unless-stopped
    environment:
      - TZ=America/Chicago
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    command: daemon --docker
    labels:
      - "ofelia.enabled=true"
      - "ofelia.job-run.weatherust.schedule=0 30 5 * * *"
      - "ofelia.job-run.weatherust.image=ghcr.io/jsprague84/weatherust:latest"
      - "ofelia.job-run.weatherust.command=--zip 52726 --units imperial --quiet"
      - "ofelia.job-run.weatherust.env=OWM_API_KEY=${OWM_API_KEY}|GOTIFY_KEY=${GOTIFY_KEY}|GOTIFY_URL=${GOTIFY_URL}|DEFAULT_ZIP=${DEFAULT_ZIP}|DEFAULT_UNITS=${DEFAULT_UNITS}"
      # CHANGE TO YOUR .env ABSOLUTE PATH ON THE HOST
      - "ofelia.job-run.weatherust.volume=/home/ubuntu/docker-compose/weatherust/.env:/app/.env:ro"
